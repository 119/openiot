<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:s="http://www.sensap.eu/jsf"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:dialogs="http://java.sun.com/jsf/composite/components/sensap/dialogs">

<f:view contentType="text/html">
	<h:head>
		<meta content='text/html; charset=UTF-8' http-equiv="Content-Type" />
		<h:outputStylesheet library="css" name="core.css" />
		<h:outputScript library="js" name="core.js" />
		<script src="http://maps.google.com/maps/api/js?sensor=false"
			type="text/javascript"></script>
		<title>#{messages.UI_REQUEST_PRESENTATION_TITLE}</title>
	</h:head>

	<h:body styleClass="request-presentation" id="body">
		<h:form id="util">
			<p:growl widgetVar="growl" escape="false" autoUpdate="true"
				showSummary="false" showDetail="true" sticky="true"
				severity="error,fatal" />
			<p:growl widgetVar="growl2" escape="false" autoUpdate="true"
				showSummary="false" showDetail="true" severity="info, warn"
				life="3000" />
			<p:poll process="@this" update="@this" interval="600"
				listener="#{requestPresentationPageController.keepAlivePing}" />

			<p:poll process="@this" update="@this" interval="30"
				listener="#{requestPresentationPageController.updateDashboard()}" />
		</h:form>

		<pe:blockUI widgetVar="windowBlockUI"
			targetSelector=".service-designer">
			<span class="ui-icon-loader-big"></span>
		</pe:blockUI>


		<pe:layout id="pageLayout" stateCookie="true" fullPage="true">

			<!-- Menubar -->
			<pe:layoutPane position="north" size="42" closable="false"
				resizable="false"
				styleClassContent="no-border menubar-layout-container">
				<h:form id="menubar">
					<p:toolbar>
						<p:toolbarGroup align="left">
							<p:button value="#{messages.UI_MENUBAR_ACTIVE_APP}" onclick="return false;"/>

							<p:selectOneMenu
								value="#{requestPresentationPageController.context.activeApplication}"
								style="margin-left:10px;position:absolute;top:6px;">
								<p:ajax event="change" process="@this"
									update="@this, :dashboardForm" />
								<f:selectItems
									value="#{requestPresentationPageController.context.applicationMap.entrySet()}"
									var="entry" itemLabelEscaped="false" itemLabel="#{entry.key}"
									itemValue="#{entry.key}" />
							</p:selectOneMenu>
						</p:toolbarGroup>
						<p:toolbarGroup align="right">

							<p:commandButton icon="ui-icon-refresh" value="#{messages.UI_MENUBAR_REFRESH}"
								process="@this"
								actionListener="#{requestPresentationPageController.updateDashboard()}" />

						</p:toolbarGroup>
					</p:toolbar>
				</h:form>
			</pe:layoutPane>

			<pe:layoutPane position="center" styleClass="no-border">
				<h:form id="dashboardForm">
					<p:dashboard
						rendered="#{! empty requestPresentationPageController.context.dashboard}"
						binding="#{requestPresentationPageController.context.dashboard}" />
				</h:form>

			</pe:layoutPane>

		</pe:layout>
	</h:body>

</f:view>
</html>

